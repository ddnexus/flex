<!DOCTYPE html>
<html>
  <head>
    <link href='/flex/assets/global-9916d5b8228587acf80f3b6895466abf.css' rel='stylesheet' type='text/css' />
<script src='/flex/assets/global-a63e4d3d89edd2025dec6b2451238b9e.js' type='text/javascript'></script>

    <title>
      FlexDoc - flex-models - Overview
    </title>
    <script type="text/javascript">
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      
      ga('create', 'UA-42574355-2', 'ddnexus.github.io');
      ga('send', 'pageview');
    </script>
  </head>
  <body>
    <div id="page-nav" class="nocontent">
      <ul id="nav-menu" class="menu_h_list"><li><a href="#" class="isLabel">Flex Project</a><ul><li><a href="/flex/doc/1-Flex-Project/1-Overview.html">Project Overview</a></li><li><a href="/flex/doc/1-Flex-Project/2-Usage-Overview.html">Usage Overview</a></li><li><a href="/flex/doc/1-Flex-Project/3-Configuration.html">Configuration</a></li><li><a href="/flex/doc/1-Flex-Project/4-Rake-Tasks.html">Rake Tasks</a></li></ul></li><li><a href="#" class="isLabel">flex</a><ul><li><a href="/flex/doc/2-flex/1-Overview.html">Overview</a></li><li><a href="/flex/doc/2-flex/2-API-Methods.html">API Methods</a></li><li><a href="#" class="isLabel">Templating</a><div class="arrow right"></div><ul><li><a href="/flex/doc/2-flex/3-Templating/1-Templates.html">Templates</a></li><li><a href="/flex/doc/2-flex/3-Templating/2-Sources.html">Template Sources</a></li><li><a href="/flex/doc/2-flex/3-Templating/3-Tags.html">Tags</a></li><li><a href="/flex/doc/2-flex/3-Templating/4-Variables.html">Variables</a></li><li><a href="/flex/doc/2-flex/3-Templating/5-Interpolation.html">Interpolation</a></li><li><a href="/flex/doc/2-flex/3-Templating/6-Partials.html">Partial Templates</a></li></ul></li><li><a href="/flex/doc/2-flex/4-Result-Extenders.html">Result Extenders</a></li><li><a href="/flex/doc/2-flex/5-Self-Documentation.html">Self Documentation</a></li><li><a href="/flex/doc/2-flex/6-Utility-Methods.html">Utility Methods</a></li></ul></li><li><a href="#" class="isLabel">flex-scopes</a><ul><li><a href="/flex/doc/3-flex-scopes/1-Overview.html">Overview</a></li><li><a href="/flex/doc/3-flex-scopes/2-Scopes.html">Scopes</a></li></ul></li><li><a href="#" class="isLabel">flex-models</a><ul><li><a href="/flex/doc/4-flex-models/1-Overview.html">Overview</a></li><li><a href="/flex/doc/4-flex-models/2-ActiveRecord-And-Mongoid-Integration.html">ActiveRecord And Mongoid Integration</a></li><li><a href="/flex/doc/4-flex-models/3-ActiveModel-Integration.html">ActiveModel Integration</a></li><li><a href="#" class="isLabel">Modules</a><div class="arrow right"></div><ul><li><a href="/flex/doc/4-flex-models/4-Modules/1-Flex::ModelSyncer.html">Flex::ModelSyncer</a></li><li><a href="/flex/doc/4-flex-models/4-Modules/2-Flex::ModelIndexer.html">Flex::ModelIndexer</a></li><li><a href="/flex/doc/4-flex-models/4-Modules/3-Flex::ActiveModel.html">Flex::ActiveModel</a></li></ul></li><li><a href="/flex/doc/4-flex-models/5-Result-Extenders.html">Result Extenders</a></li></ul></li><li><a href="#" class="isLabel">flex-rails</a><ul><li><a href="/flex/doc/5-flex-rails/1-overview.html">Overview</a></li><li><a href="/flex/doc/5-flex-rails/2-Result-Extenders.html">Result Extenders</a></li></ul></li><li><a href="#" class="isLabel">flex-admin</a><ul><li><a href="/flex/doc/6-flex-admin/1-Binary.html">Binary</a></li><li><a href="/flex/doc/6-flex-admin/2-Live-Reindex.html">Live Reindex</a></li></ul></li><li><a href="#" class="isLabel">Tutorials</a><ul><li><a href="/flex/doc/7-Tutorials/1-Flex-vs-Tire.html">Why you should use Flex rather than Tire</a></li><li><a href="/flex/doc/7-Tutorials/2-Migrate-from-0.x.html">How to migrate from flex 0.x</a></li><li><a href="/flex/doc/7-Tutorials/3-Index-and-Search-your-Models.html">Index and Search your Models</a></li><li><a href="/flex/doc/7-Tutorials/4-Index-and-Search-External-Data.html">Index and Search External Data</a></li></ul></li></ul>
      <div id="google-search">
        <script type="text/javascript">
          (function() {
            var cx = '001168365143071728136:m_m7r3q0dhs';
            var gcse = document.createElement('script');
            gcse.type = 'text/javascript';
            gcse.async = true;
            gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
                '//www.google.com/cse/cse.js?cx=' + cx;
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(gcse, s);
          })();
        </script>
        <gcse:search>&nbsp;</gcse:search>
      </div>
    </div>
    <div id="page-toc"></div>
    <div id="content">
      <a id="badge" href="https://badge.fury.io/rb/flex-models"><img src="https://badge.fury.io/rb/flex-models.png" /></a>
      <div class="breadcrumb nocontent">
        <span><a href="/flex/doc">FlexDoc</a></span> &gt; <span><a href="/flex/doc/4-flex-models">flex-models</a></span> &gt; <span>Overview</span>
      </div>
      <h1 id='flexmodels__overview'>flex-models - Overview</h1>

<p>The <code>flex-models</code> gem provides the means to map and sync your data to elasticsearch. Its interface tries to be as minimalistic and declarative as possible and can integrate your models with elasticsearch basically in 2 ways, handy in different contexts.</p>

<h2 id='1_transparent_integration_with_activerecord_and_mongoid_models'>1. Transparent integration with ActiveRecord and Mongoid models</h2>

<blockquote>
<p>This is useful when the data you need to index is in some DB(s) managed by your application.</p>
</blockquote>

<p>Index and keep automaticaly synced your DBs with elasticsearch with just a few declarations in your models. You can mirror 1 to 1 your DBs to the index/indices, but you can also map any DB structure to any index structure you may design in order to ease the querying. You have the complete control over which data gets indexed and how it gets indexed, transparently managing elasticsearch parent/child relationships, also polymorphic (see <a href='/flex/doc/4-flex-models/2-ActiveRecord-And-Mongoid-Integration.html'>ActiveRecord And Mongoid Integration</a> and <a href='/flex/doc/7-Tutorials/3-Index-and-Search-your-Models.html'>Index and Search your Models</a>).</p>

<h2 id='2_direct_integration_throught_activemodel'>2. Direct integration throught ActiveModel</h2>

<blockquote>
<p>This is useful when the index doesn&#8217;t come from data in any DB(s) or when you want to use the elasticsearch index as a data storage.</p>
</blockquote>

<p>Manage the elasticsearch index as it were a DB, through <code>ActiveModel</code> models. Get validations and callbacks, typecasting, attribute defaults, persistent storage, with optimistic lock update, finders, chainable scopes etc. (see <a href='/flex/doc/4-flex-models/3-ActiveModel-Integration.html'>ActiveModel Integration</a> and <a href='/flex/doc/7-Tutorials/4-Index-and-Search-External-Data.html'>Index and Search External Data</a>)</p>

<h2 id='setup'>Setup</h2>

<p>Flex needs to know your Flex models, and in which order you want them to be imported in the index (in case of bulk import of the DB and parent/child relations), so each time you add a <code>include Flex::ModelIndexer</code> or <code>include Flex::ActiveModel</code> statement, remember to add the model class name to the <code>config.flex_models</code> and/or <code>config.flex_active_models</code> arrays in the initializer file.</p>
<div class='highlight'><pre><code class='ruby'><span class='n'>config</span><span class='o'>.</span><span class='n'>flex_models</span> <span class='o'>=</span> <span class='sx'>%w[ Thread Post ]</span>
<span class='n'>config</span><span class='o'>.</span><span class='n'>flex_active_models</span> <span class='o'>=</span> <span class='sx'>%w[ WebContent ]</span>
</code></pre></div>
<h2 id='elasticsearch_mapping'>Elasticsearch Mapping</h2>

<p>Flex provides a default mapping that keeps into consideration also your parent/child relations, and the properties declared for <code>Flex::ActiveModel</code> models. The default mapping is deep-merged with your <code>flex.yml</code> file (see <a href='/flex/doc/1-Flex-Project/3-Configuration.html'>Configuration</a>), that is expected to contain all the mapping that you may want to define/override, written in friendly <code>YAML</code>.</p>

<p>Notice that in order to have the automatic routing and mapping for parent/child relationships you must either run the <code>flex:import FORCE=true</code> task (which will create a new index), or the <code>flex:index:create</code> task (see <a href='/flex/doc/1-Flex-Project/4-Rake-Tasks.html'>Rake Tasks</a>).</p>

<h2 id='dynamic_indices'>Dynamic Indices</h2>

<p>You can implement dynamic indices very easily by just defining an instance method in your model:</p>
<div class='highlight'><pre><code class='ruby'><span class='k'>def</span> <span class='nf'>flex_index</span>
  <span class='n'>old_creation_date?</span> <span class='p'>?</span> <span class='s1'>&#39;old_index&#39;</span> <span class='p'>:</span> <span class='s1'>&#39;new_index&#39;</span>
<span class='k'>end</span>
</code></pre></div>
<blockquote>
<p>You can also override other metafields by defining a similar method (see <a href='/flex/doc/4-flex-models/4-Modules/2-Flex::ModelIndexer.html#overriding_flex_metafields'>Overriding Flex Metafields</a>)</p>
</blockquote><br />
      <div class="breadcrumb nocontent">
        <span><a href="/flex/doc">FlexDoc</a></span> &gt; <span><a href="/flex/doc/4-flex-models">flex-models</a></span> &gt; <span>Overview</span>
      </div>
    </div>
    <div id="footer" class="nocontent">
      Copyright &copy; 2012-2013 by <a href="mailto://dd.nexus@gmail.com">Domizio Demichelis</a> &mdash; Sponsored by <a href="http://www.escalatemedia.com">Escalate Media</a> and <a href="http://www.barquin.com">Barquin International</a>
    </div>
  </body>
</html>